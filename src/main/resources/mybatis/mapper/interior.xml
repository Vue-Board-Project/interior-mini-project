<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
                 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mycompany.webapp.dao.mybatis.InteriorDao">
	<!-- 모델, 포폴 전체창 insert -->
	<insert id="insertInterior" parameterType="Interior">
		<selectKey keyProperty="ino" resultType="int" order="BEFORE">
	         select INO_SEQUENCE.nextval from dual
	    </selectKey>
	    INSERT INTO interior (ino, itype, ihits, istyle, all_color, wcolor, fcolor, dtype, darea, isummary, im_img_path)
		values (#{ino}, #{itype}, 0, #{istyle}, #{allColor}, #{wcolor}, #{fcolor}, #{dtype}, #{darea}, #{isummary}, #{imImgPath})
	</insert>
	
	<!-- 포폴 상세창 -->
	<select id="detailPortfolio" parameterType="int" resultType="Interior">
		SELECT itype, istyle, darea, isummary, im_img_path as imImgPath
		FROM interior WHERE ino = #{ino}
	</select>
	
	<!-- <sql id="dtype">
		<if test="dtype ==''">
		</if>
		<if test="dtype =='normal'">
			and dtype='normal'
		</if>
		<if test="dtype =='infant'">
			and dtype='infant'
		</if>
		<if test="dtype =='special'">
			and dtype='special'
		</if>
	</sql> -->
	
	<!-- 포폴 최신순 -->
	<select id="interiorList" resultType="Interior">
		SELECT ino, isummary, im_img_path as imImgPath
		FROM interior WHERE itype='portfolio' 
 		<!-- <include refid="dtype"/> -->
		order by ino desc
	</select>
	
	<!-- 포폴 과거순 -->
	<select id="interiorListPast" resultType="Interior">
		SELECT ino, isummary, im_img_path as imImgPath
		FROM interior WHERE itype='portfolio' order by ino asc
	</select>
	
	<!-- 포폴 인기순 -->
	<select id="interiorListPopular" resultType="Interior">
		SELECT ino, isummary, im_img_path as imImgPath
		FROM interior WHERE itype='portfolio' order by ihits desc
	</select>
	
	<!-- 포폴 수 -->
	<select id="interiorCnt" resultType="int">
		SELECT count(*) AS cnt FROM interior WHERE itype='portfolio'
	</select>
	
	<!-- 포폴 비숫한 스타일 추천 -->
	<select id="recommendStyle" resultType="Interior">
		SELECT ino, im_img_path as imImgPath
		FROM interior WHERE itype='portfolio' and istyle=#{istyle} order by ihits desc
	</select>
	<!-- 포폴 비슷한 평수 추천 -->
	<select id="recommendArea" resultType="Interior">
		SELECT ino, im_img_path as imImgPath
		FROM interior WHERE itype='portfolio' and darea=#{darea} order by ihits desc
	</select>
	
	<!-- 포폴,모델 조회수 -->
	<update id="updateCnt" parameterType="Interior">
		UPDATE interior SET ihits = ihits+1 WHERE ino=#{ino} 
	</update>
</mapper>

