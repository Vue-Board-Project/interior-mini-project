<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mycompany.webapp.dao.mybatis.ProductDao">
	<!--상품 추가 테스트용(추후 주석 처리 예정)-->
	<insert id="insertproduct" parameterType="product">
		<if test="mainImage==null">
			insert into product(MODEL_NUMBER, PRODUCT_NAME, PRICE, REGISTRATION_DATE, PRODUCT_QUANTITY, PRODUCT_HITS, 
			PRODUCT_SALES_VOLUME, PRODUCT_COLOR, REVIEW_COUNT, CATEGORY, PATTACHONAME, PATTACHSNAME, PATTACHTYPE)
			values(#{modelNumber}, #{productName}, #{price}, SYSDATE, #{productQuantity}, 0, 
			0, #{productColor}, 0, #{category}, null, NULL, NULL)
		</if>
		<if test="mainImage!=null">
			insert into product(MODEL_NUMBER, PRODUCT_NAME, PRICE, REGISTRATION_DATE, PRODUCT_QUANTITY, PRODUCTI_HITS, 
			PRODUCT_SALES_VOLUME, PRODUCT_COLOR, REVIEW_COUNT, CATEGORY, PATTACHONAME, PATTACHSNAME, PATTACHTYPE)
			values(#{modelNumber}, #{productName}, #{price}, SYSDATE, #{productQuantity}, 0, 
			0, #{productColor}, 0, #{category}, #{pattachoname}, #{pattachsname}, #{pattachtype})
		</if>
	</insert>
	<update id="saveImage" parameterType="java.util.Map">
		UPDATE product SET MAINIMAGE= #{bytes, jdbcType=BLOB, javaType=[B} WHERE MODEL_NUMBER='lc0001whi'
	</update>
	<!-- 유니트 체어 상품 전체 리스트 불러오기 -->
	<select id="selectchairlist" resultType="product"> <!-- PATTACHONAME, PATTACHSNAME, PATTACHTYPE -->
		select MODEL_NUMBER as modelNumber, product_name as productName, product_intro as productIntro, category,
		price,
		PATTACHONAME as pattachoname
		from product
		<include refid='category'></include>
		order by REGISTRATION_DATE desc
	</select>
	<!--베스트 상품 3순위-->
	<select id="selectbestlist" resultType="product"> <!-- PATTACHONAME, PATTACHSNAME, PATTACHTYPE -->
		select MODEL_NUMBER as modelNumber, product_name as productName, product_intro as productIntro, category, PATTACHONAME
		from product
		<include refid='category'></include>
		order by PRODUCT_SALES_VOLUME desc
	</select>
	
	<select id="soltsalesCount" resultType="product"> <!-- PATTACHONAME, PATTACHSNAME, PATTACHTYPE -->
		select product_name as productName, product_intro as productIntro
		from product
		where CATEGORY='unitchair' and rownum le 3
		ORDER BY PRODUCT_SALES_VOLUME DESC
	</select>
	<select id="soltviewCount" resultType="product"> <!-- PATTACHONAME, PATTACHSNAME, PATTACHTYPE -->
		select product_name as productName, product_intro as productIntro
		from product
		where CATEGORY='unitchair'
		ORDER BY PRODUCT_HITS DESC
	</select>
	<select id="soltreviewCount" resultType="product"> <!-- PATTACHONAME, PATTACHSNAME, PATTACHTYPE -->
		select product_name as productName, product_intro as productIntro
		from product
		where CATEGORY='unitchair'
		ORDER BY REVIEW_COUNT DESC
	</select>
	<select id="solttime" resultType="product"> <!-- PATTACHONAME, PATTACHSNAME, PATTACHTYPE -->
		select product_name as productName, product_intro as productIntro
		from product
		where CATEGORY='unitchair'
		order by REGISTRATION_DATE desc
	</select>
	<sql id="category">
		<!-- <if test="category == null">
			'unitchair'
		</if> -->
		<if test="category == 'unitchair'">
			where CATEGORY='unitchair'
		</if>
		
	</sql>
	
	
	<!--상품 상세보기-->
	<select id="selectDetailProduct" parameterType="string" resultType="product">
		select 
			MODEL_NUMBER as modelNumber,
			PRODUCT_NAME as productName,
			PRODUCT_INTRO as productIntro,
			PRICE,
			PRODUCT_COLOR as productColor,
			REVIEW_COUNT as reviewCount,
			PATTACHONAME
		from PRODUCT
		where MODEL_NUMBER=#{modelNumber}
	</select>
</mapper>